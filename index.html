<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baloo's Bite - SVM Edition</title>
    <style>
        body {
            background-color: #1a1a1a;
            color: #ffffff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }
        .container {
            text-align: center;
            background: #2a2a2a;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.5);
            border: 2px solid #ff8c00;
        }
        h1 { color: #ff8c00; margin-bottom: 1rem; }
        .dog-emoji { font-size: 80px; margin: 20px 0; }
        #status { font-weight: bold; color: #00ffcc; margin: 15px 0; font-family: monospace; }
        input[type=range] { width: 100%; margin: 20px 0; }
        button {
            background-color: #ff8c00;
            border: none;
            color: white;
            padding: 15px 32px;
            font-size: 20px;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        button:hover { transform: scale(1.05); background-color: #e67e00; }
    </style>
</head>
<body>

<div class="container">
    <h1>BALOO'S BITE</h1>
    <div class="dog-emoji">üêï</div>
    
    <div id="status">WALLET STATUS: DISCONNECTED</div>
    
    <p>Adjust your bite amount:</p>
    <input type="range" id="bet-slider" min="0.1" max="10" step="0.1" value="0.25" oninput="updateDisplay(this.value)">
    <p><span id="bite-amount">0.25</span> XNT</p>

    <button onclick="chomp()">CHOMP!</button>
</div>

<script>
    let publicKey = null;

    function updateDisplay(val) {
        document.getElementById('bite-amount').innerText = val;
    }

    // Connect to the X1 SVM Wallet
    async function connectWallet() {
        try {
            const provider = window.x1; 
            if (provider && provider.isX1) {
                const response = await provider.connect();
                publicKey = response.publicKey.toString();
                document.getElementById('status').innerText = "CONNECTED: " + publicKey;
                console.log("SVM Wallet connected:", publicKey);
            } else {
                document.getElementById('status').innerText = "X1 WALLET NOT FOUND";
            }
        } catch (err) {
            console.error("Connection error:", err);
            document.getElementById('status').innerText = "CONNECTION FAILED";
        }
    }

    // Trigger the transaction verzoek
    async function chomp() {
        if (!publicKey) {
            await connectWallet();
            return;
        }

        try {
            const provider = window.x1;
            const amount = document.getElementById('bet-slider').value;
            
            alert("Ready to bite " + amount + " XNT. Please confirm in your X1 Wallet!");

            // Since X1 is SVM, we send a signMessage request to trigger the wallet
            const message = "Baloo Bite Confirmation: " + amount + " XNT";
            const encodedMessage = new TextEncoder().encode(message);
            const signedMessage = await provider.signMessage(encodedMessage, "utf8");

            console.log("Bite Signature:", signedMessage);
            alert("BITE SUCCESSFUL! Transaction signed.");
        } catch (err) {
            console.error("Bite failed:", err);
            alert("Bite rejected by wallet.");
        }
    }

    // Auto-check for wallet on load
    window.addEventListener('load', () => {
        if (window.x1) connectWallet();
    });
</script>

</body>
</html>
