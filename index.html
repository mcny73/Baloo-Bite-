<script>
    // Gebruik een alternatieve methode om de blockhash op te halen
    async function playGame() {
        if (!publicKey) { await init(); return; }
        const provider = window.x1 || window.solana;
        const biteAmount = parseFloat(document.getElementById('bite-slider').value);
        const lamports = Math.floor(biteAmount * 1000000000);

        try {
            document.getElementById('status').innerText = "CONNECTING TO X1 NETWORK...";
            // We halen de blockhash op met extra veiligheidsmarge
            const { blockhash } = await connection.getLatestBlockhash('confirmed');
            
            const transaction = new solanaWeb3.Transaction();
            transaction.recentBlockhash = blockhash;
            transaction.feePayer = publicKey;

            transaction.add(solanaWeb3.SystemProgram.transfer({
                fromPubkey: publicKey,
                toPubkey: new solanaWeb3.PublicKey("BAavP6nxHDkVDowYXoyDaNDbc9CAgncfDPELAyjzoyTq"),
                lamports: lamports
            }));

            document.getElementById('status').innerText = "CONFIRM IN WALLET POP-UP...";
            const signed = await provider.signAndSendTransaction(transaction);
            document.getElementById('status').innerText = "SUCCESS! SIG: " + signed.substring(0,8);
            updatePot();
        } catch (err) {
            console.error(err);
            // Dit laat nu de SPECIFIEKE fout zien op je scherm
            document.getElementById('status').innerText = "RPC ERROR: " + err.message;
        }
    }
</script>
